---
title: Next.jsì—ì„œ ë‹¤êµ­ì–´ ì ìš©í•˜ê¸°
description: next-i18nextë¥¼ ì´ìš©í•´ì„œ ë‹¤êµ­ì–´ë¥¼ ì ìš©í•´ë³´ì•„ìš”
date: 2022-10-07 11:00:19
published: true
slug: nextjs-i18n
tags:
  - Next.js
  - i18n
  - next-i18next
---

# next.jsì— ë‹¤êµ­ì–´ ì ìš©í•˜ê¸°

# ì‚¬ì „ ì¤€ë¹„

## ğŸ“šÂ ì‚¬ìš©í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬

- next-i18next
- react-i18next
- google-spreadsheet

---

## âš™ï¸ next.config

- `next-i18next.config.js` ì¶”ê°€

  ```jsx
  module.exports = {
    i18n: {
      defaultLocale: "ko",
      locales: ["ko", "en"],

      /** trueë¡œ ì„¤ì • ì‹œ Next.jsì—ì„œ ìë™ìœ¼ë¡œ ì ‘ì†í•œ ì‚¬ìš©ìì˜ ë¡œì¼€ì¼ë¡œ í‘œì‹œí•¨ */
      localeDetection: false,

      pages: {
        "*": ["common"],
      },
    },
  };
  ```

- `next.config.js` ì ìš©

  ```jsx
  const { i18n } = require("./next-i18next.config");

  const nextConfig = {
    // ...
    i18n,
  };
  ```

---

## ğŸ§² êµ¬ê¸€ ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ì—ì„œ ë²ˆì—­ íŒŒì¼ ê°€ì ¸ì˜¤ê¸°

1. êµ¬ê¸€ ìŠ¤í”„ë ˆë“œ ì‹œíŠ¸ API ì¸ì¦

[google-spreadsheet - Google Spreadsheets API -- simple interface to read/write data and manage sheets](https://theoephraim.github.io/node-google-spreadsheet/#/getting-started/authentication?id=service-account)

1. ë³€í™˜ ì†ŒìŠ¤ ì‘ì„±

- `getLocaleData.js`

  ```jsx
  const { GoogleSpreadsheet } = require("google-spreadsheet");
  const fs = require("fs");
  const secret = require("config íŒŒì¼ ê²½ë¡œ");

  const doc = new GoogleSpreadsheet("sheetId");

  const init = async () => {
    await doc.useServiceAccountAuth({
      client_email: secret.client_email,
      private_key: secret.private_key,
    });
  };

  const read = async () => {
    await doc.loadInfo();
    const sheet = doc.sheetsByIndex[0];

    await sheet.loadHeaderRow();
    const colTitles = sheet.headerValues;
    const rows = await sheet.getRows();

    let result = {};

    rows.map((row) => {
      colTitles.slice(1).forEach((title) => {
        result[title] = result[title] || [];
        const key = row[colTitles[0]];
        result = {
          ...result,
          [title]: {
            ...result[title],
            [key]: row[title] !== "" ? row[title] : undefined,
          },
        };
      });
    });

    return result;
  };

  const write = (data) => {
    Object.keys(data).forEach((key) => {
      fs.writeFile(
        `./public/locales/${key}/common.json`,
        JSON.stringify(data[key], null, 2),
        (err) => {
          if (err) {
            console.log(err);
          }
        }
      );
    });
  };

  init()
    .then(() => read())
    .then((data) => write(data))
    .catch((err) => console.log(err));
  ```

---

## ğŸ‘‚ next-i18next.d.ts

> ê°œë°œ ì‹œ í¸ì˜ì„± í–¥ìƒì„ ìœ„í•œ ì„¸íŒ…

- `tsconfig.json` â†’ public í´ë” alias ì¶”ê°€
  ```jsx
  {
    "compilerOptions": {
      // ...
      "typeRoots": ["@types"],
      "paths": {
        "@public/*": ["../public/*"]
      }
    }
  	// ...
  }
  ```
- `src/@types/next-i18next.d.ts`

  ```tsx
  import "react-i18next";
  import common from "@public/locales/ko/common.json";

  declare module "react-i18next" {
    interface CustomTypeOptions {
      defaultNS: "common";
      resources: {
        common: typeof common;
      };
    }
  }
  ```

---

# ì ìš©

## ğŸš€ í˜ì´ì§€ì— ì ìš©

ë¨¼ì € `_app`ì„ `appWithTranslation`ë¡œ ê°ì‹¸ì¤€ë‹¤.

```jsx
// _app.tsx

...

export default wrapper.withRedux(appWithTranslation(App));
```

ê·¸ë¦¬ê³  ê° í˜ì´ì§€ì—ì„œ `getStaticProps` í˜¹ì€ `getServerSideProps`ë¥¼ ì¶”ê°€í•´ì¤€ë‹¤.

- ìì£¼ ì‚¬ìš©í•˜ëŠ” ë¡œì§ ìœ í‹¸ í•¨ìˆ˜ ìƒì„± â†’ `utils/i18n.ts`

  ```tsx
  import { serverSideTranslations } from "next-i18next/serverSideTranslations";
  import { GetServerSidePropsContext, GetStaticPropsContext } from "next";

  export const makeLocaleProps = async (
    context: GetServerSidePropsContext | GetStaticPropsContext,
    ns = ["common"]
  ) => {
    const { locale } = context;

    if (locale) {
      return {
        ...(await serverSideTranslations(locale, ns)),
      };
    }

    return {};
  };

  export const makeStaticProps =
    (ns = ["common"]) =>
    async (context: GetServerSidePropsContext | GetStaticPropsContext) => {
      return {
        props: {
          ...(await makeLocaleProps(context, ns)),
        },
      };
    };
  ```

- getStaticProps ì¶”ê°€í•˜ê¸°

  ```jsx
  // ...

  export const getStaticProps = makeStaticProps();

  export default Page;
  ```

- getServerSideProps ì¶”ê°€í•˜ê¸°

  ```jsx
  export async function getServerSideProps(context: GetServerSidePropsContext) {
    const props = {
      ...(await makeLocaleProps(context)),
    };

    // ...

    return {
      props,
    };
  }

  export default Page;
  ```

---

# ì‚¬ìš©

```jsx
import { useTranslation } from 'next-i18next';

const Component = () => {
	const { t } = useTranslation();

	return {
		<section>
			<h1>{t("hello")}</h1>
		</section>
	}
}
```

`t` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ì„œ ë‹¤êµ­ì–´ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

## ê¸°ë³¸

```jsx
// { "ì•ˆë…•í•˜ì„¸ìš”": "ì•ˆë…•í•˜ì„¸ìš”" }
<p>{t("common:ì•ˆë…•í•˜ì„¸ìš”")}</p>
```

## ë³€ìˆ˜ ì‚¬ìš©

```jsx
// { "ì´ë¦„": "ì €ëŠ” {{name}}ì…ë‹ˆë‹¤." }
<p>{t("home:ì´ë¦„", { name })}</p>
```

## ì»´í¬ë„ŒíŠ¸ ì™¸ë¶€ì—ì„œ ì‚¬ìš©

```tsx
import { i18n, useTranslation } from "next-i18next";

const outsideI18n = () => {
  return i18n?.t("ì•ˆë…•í•˜ì„¸ìš”");
};

const Component = () => {
  const { t } = useTranslation();

  return (
    <div>
      <h1>{t("ì•ˆë…•í•˜ì„¸ìš”")}</h1>
      <h1>{outsideI18n()}</h1>
    </div>
  );
};

export default Component;
```

## ë¦¬ìŠ¤íŠ¸

```jsx
// { "í•­ëª©": ["ì˜¤ëŠ˜ ì ì‹¬ì€ ë¬´ì—‡ì„ ë¨¹ì„ê¹Œìš”", "ì˜¤ëŠ˜ ì €ë…ì„ ë¬´ì—‡ì„ ë¨¹ì„ê¹Œìš”?"] }
{
  (t("home:í•­ëª©", { returnObjects: true }) as [])?.map((elem) => (
    <li key={elem}>{elem}</li>
  ));
}
```

## Trans component

ê°„í˜¹ í…ìŠ¤íŠ¸ ì¤‘ê°„ì— ìŠ¤íƒ€ì¼ì´ ë‹¤ë¥¸ ê²½ìš° â†’ ì•ˆë…•í•˜ì„¸ìš” {{***í•­ê³µì‚¬**}} **\***ì…ë‹ˆë‹¤. ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.

```jsx
import { useTranslation, Trans } from 'next-i18next';

const Component = () => {
	const { t } = useTranslation();
	const airlineName = getAirlineName();

	return {
		<section>
			<Trans t={t} i18key="í•­ê³µì‚¬_ì¸ì‚¬" values={{
				airlineName,
			}}>
				ì•ˆë…•í•˜ì„¸ìš” <b>{airlineName}</b> ì…ë‹ˆë‹¤.
			</Trans>
		</section>
	}
}
```

## ë¼ìš°íŒ…

```jsx
export default function Home() {
  const router = useRouter();
  const { pathname, asPath, query } = router;

  return (
    <select
      defaultValue={router.locale}
      onChange={(e) =>
        router.push({ pathname, query }, asPath, { locale: e.target.value })
      }
    >
      <option value="ko">{t("common:í•œêµ­ì–´")}</option>
      <option value="en">{t("common:ì˜ì–´")}</option>
      <option value="ja">{t("common:ì¼ë³¸ì–´")}</option>
    </select>
  );
}
```

## íŒŒì¼ ë¶„ë¦¬

> ë§Œì•½ namespaceë¥¼ ë¶„ë¦¬í•´ì„œ ì‚¬ìš©í•œë‹¤ë©´ ì•„ë˜ì²˜ëŸ¼ ê°€ì ¸ì˜¬ namespaceë¥¼ ì§€ì •í•´ì„œ ê·¸ ë²ˆì—­ë³¸ë§Œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.

```jsx
export async function getStaticProps({ locale }: GetStaticPropsContext) {
  if (locale) {
    return {
      props: {
        ...(await serverSideTranslations(locale, ["home"])),
      },
    };
  }

  return {
    props: {},
  };
}
```

â†’ `serverSideTranslations` ë‘ë²ˆì§¸ ì¸ìì— namespaceë¥¼ ë„£ì–´ì¤€ë‹¤.

# ì°¸ê³ 

[https://github.com/i18next/next-i18next](https://github.com/i18next/next-i18next)

[https://theoephraim.github.io/node-google-spreadsheet/#/](https://theoephraim.github.io/node-google-spreadsheet/#/)
